

<script>
	var current_speech_id = "11";
	var	transcript_text_array = [{id:"11",short_split_id:"ll",user_id:"yuta", script:"aa", type:"speaker"},
															 {id:"22",short_split_id:"ll",user_id:"yuta", script:"bb", type:"speaker"},
															 {id:"11",short_split_id:"ll",user_id:"yuta", script:"cc", type:"speaker"},
															 {id:"11",short_split_id:"ll",user_id:"yuta", script:"dd", type:"speaker"},
															 {id:"11",short_split_id:"mm",user_id:"mori", script:"ee", type:"poi"},
															 {id:"11",short_split_id:"mm",user_id:"mori", script:"ff", type:"poi"},
															 {id:"11",short_split_id:"nn",user_id:"yuta", script:"gg", type:"speaker"},
															 {id:"11",short_split_id:"oo",user_id:"mori", script:"hh", type:"poi"},
															 {id:"11",short_split_id:"oo",user_id:"mori", script:"ii", type:"poi"},
															 {id:"11",short_split_id:"oo",user_id:"mori", script:"jj", type:"poi"},
															 {id:"11",short_split_id:"oo",user_id:"mori", script:"kk", type:"poi"},
															 {id:"11",short_split_id:"pp",user_id:"yuta", script:"ll", type:"speaker"},
															 {id:"11",short_split_id:"pp",user_id:"yuta", script:"mm", type:"speaker"}]
	var filter_trans_array = transcript_text_array.filter(
		function (value){
			return (value.id==current_speech_id)
		}
	);
	console.log(filter_trans_array);

	var short_speaker_text = "";
	for(var i=0; i< filter_trans_array.length; i++){
		short_speaker_text = short_speaker_text + filter_trans_array[i]["script"];
		if(i < filter_trans_array.length -1){
			if(filter_trans_array[i]["short_split_id"] != filter_trans_array[i+1]["short_split_id"] ){
				var obj = {};
				obj["transcription_message"] = short_speaker_text;
				obj["speaker_role"] = filter_trans_array[i]["type"];
				obj["speaker_name"] = filter_trans_array[i]["user_id"];
				if(obj["speaker_role"] == "speaker"){
					obj["transcription_box_class"] = "transcript_speaker";
				}else{
					obj["transcription_box_class"] = "transcript_poi";
				}

				console.log(obj);
				short_speaker_text = "";
			}
		}else{  //last
				var obj = {};
				obj["transcription_message"] = short_speaker_text;
				obj["speaker_role"] = filter_trans_array[i]["type"];
				obj["speaker_name"] = filter_trans_array[i]["user_id"];
				if(obj["speaker_role"] == "speaker"){
					obj["transcription_box_class"] = "transcript_speaker";
				}else{
					obj["transcription_box_class"] = "transcript_poi";
				}
				console.log(obj);
		}
	}




</script>